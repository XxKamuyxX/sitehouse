---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog', ({ data }) => {
    return import.meta.env.PROD ? data.draft !== true : true;
  });
  
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout>
  <Header />
  <main class="pt-24 pb-16">
    <article class="py-20 md:py-32 bg-white">
      <div class="container mx-auto px-4 md:px-6 lg:px-8 max-w-4xl">
        <a 
          href="/blog"
          class="inline-flex items-center gap-2 text-amber-600 hover:text-amber-700 mb-8 transition-colors"
        >
          ← Voltar para o blog
        </a>

        {post.data.image && (
          <img 
            src={post.data.image} 
            alt={post.data.title}
            class="w-full h-64 md:h-96 object-cover rounded-2xl mb-8 shadow-xl"
            loading="eager"
          />
        )}

        <header class="mb-8">
          <div class="flex items-center gap-2 mb-4">
            {post.data.tags && post.data.tags.map((tag) => (
              <span class="text-sm bg-amber-100 text-amber-800 px-3 py-1 rounded-full">
                {tag}
              </span>
            ))}
          </div>
          <h1 class="text-4xl md:text-5xl lg:text-6xl font-serif font-bold mb-4 text-slate-900">
            {post.data.title}
          </h1>
          <p class="text-xl text-slate-600 mb-4">
            {post.data.description}
          </p>
          <div class="flex items-center gap-4 text-slate-500 text-sm">
            <span>Por {post.data.author}</span>
            <span>•</span>
            <time>{new Date(post.data.pubDate).toLocaleDateString('pt-BR', { 
              day: 'numeric', 
              month: 'long', 
              year: 'numeric' 
            })}</time>
          </div>
        </header>

        <div class="prose prose-lg prose-slate max-w-none">
          <Content />
        </div>

        <div class="mt-12 p-8 bg-gradient-to-r from-amber-50 to-amber-100 rounded-2xl border-2 border-amber-200">
          <h3 class="text-2xl font-serif font-bold mb-4 text-slate-900">
            Precisa de Ajuda com Sua Cortina de Vidro?
          </h3>
          <p class="text-slate-700 mb-6">
            Entre em contato com a House Manutenção e agende uma avaliação técnica gratuita.
          </p>
          <a 
            href="https://wa.me/5531982798513?text=Olá! Gostaria de solicitar um orçamento para manutenção de cortina de vidro."
            target="_blank"
            rel="noopener noreferrer"
            class="inline-block bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-lg font-semibold text-lg uppercase tracking-wider transition-colors shadow-lg hover:shadow-xl"
          >
            Solicitar Orçamento
          </a>
        </div>
      </div>
    </article>
  </main>
  <Footer />
</Layout>

<style>
  .prose h2 {
    @apply text-3xl font-serif font-bold text-slate-900 mt-8 mb-4;
  }
  .prose h3 {
    @apply text-2xl font-serif font-bold text-slate-900 mt-6 mb-3;
  }
  .prose p {
    @apply text-slate-700 leading-relaxed mb-4;
  }
  .prose ul, .prose ol {
    @apply text-slate-700 mb-4;
  }
  .prose li {
    @apply mb-2;
  }
  .prose strong {
    @apply font-bold text-slate-900;
  }
</style>

